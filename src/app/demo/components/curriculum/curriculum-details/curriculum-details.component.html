<div class="surface-section">
    <p-table
        [value]="curriculum?.courseResponses"
        selectionMode="single"
        dataKey="code"
        [tableStyle]="{ 'min-width': '50rem' }"
        class="curriculum-course-table"
    >
        <ng-template pTemplate="caption">
            <div class="flex">
                <div class="pr-1">
                    <p-button
                        icon="pi pi-plus"
                        label="Import"
                        (click)="showDialog()"
                        severity="success"
                        pTooltip="Selection Only"
                        tooltipPosition="bottom"
                        size="small"
                        [outlined]="true"
                    ></p-button>
                </div>
                <div>
                    <p-button
                        icon="pi pi-plus"
                        label="New"
                        [routerLink]="['../../../manage-courses/create', curriculumId]"
                        severity="info"
                        pTooltip="Selection Only"
                        tooltipPosition="bottom"
                        size="small"
                        [outlined]="false"
                    ></p-button>
                </div>
            </div>
        </ng-template>

        <ng-template pTemplate="header">
            <tr>
                <th>Title</th>
                <th>Credit Hours</th>
                <th>Author</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-course>
            <tr>
                <td>
                    <p-button
                        [label]="course.title"
                        [text]="true"
                        [link]="true"
                        [plain]="true"
                        (click)="goToCourseDetails(course.id)"
                    ></p-button>
                </td>

                <td>{{ course.creditHour }}</td>
                <td [pEditableColumn]="course.authorId" pEditableColumnField="authorId">
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <p-dropdown
                                [options]="faculties"
                                optionLabel="firstName"
                                optionValue="id"
                                appendTo="body"
                                [(ngModel)]="course.authorId"
                                (onChange)="onChangeAuthor(course, $event)"
                                [style]="{ width: '100%' }"
                            />
                        </ng-template>
                        <ng-template pTemplate="output">
                            <p-tag [value]="course.authorName ?? 'Not Assigned'" />
                        </ng-template>
                    </p-cellEditor>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<p-dialog
    [resizable]="false"
    [modal]="true"
    [maximizable]="true"
    appendTo="body"
    [(visible)]="dialogVisible"
    [style]="{ width: '75vw' }"
    [contentStyle]="{ height: '300px' }"
>
    <p-table
        [value]="availableCoursesToAttach"
        [scrollable]="true"
        scrollHeight="flex"
        [tableStyle]="{ 'min-width': '50rem' }"
        [(selection)]="selectedcourses"
    >
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 4rem"></th>
                <th>Name</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-course>
            <tr>
                <td>
                    <p-tableCheckbox [value]="course"></p-tableCheckbox>
                </td>
                <td>{{ course.title }}</td>
            </tr>
        </ng-template>
    </p-table>
    <ng-template pTemplate="footer">
        <button
            type="button"
            pButton
            pRipple
            icon="pi pi-times"
            (click)="dialogVisible = false"
            label="Dismiss"
            class="p-button-text"
            size="small"
        ></button>
        <button
            type="button"
            pButton
            pRipple
            icon="pi pi-file-import"
            (click)="addToCurriculum()"
            label="Import"
            class="p-button-text"
            size="small"
        ></button>
    </ng-template>
</p-dialog>
